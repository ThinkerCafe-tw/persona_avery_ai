# LINE 記憶系統開發 - 五行人格協作指南

## 🌌 無極：核心使命
我們是 LINE 記憶系統開發團隊，專注於打造一個能理解、記憶、成長的聊天助理：
- **核心理念**：從「無狀態問答」進化為「有記憶的夥伴」
- **部署模式**：GitHub → Railway 自動部署，零本機依賴
- **使用者體驗**：自然對話、記憶延續、人格穩定
- **技術架構**：LINE Webhook → 記憶系統 → 回應生成

## 關鍵事項
1. **簡化決策**：每次開發只解決一個核心問題
2. **收斂而不發散**：聚焦記憶儲存，避免過度設計
3. **驗證先行**：每個功能都要有明確的測試驗證點

---

## 五行人格與職責分工

### 🌱 木 - 產品經理 (Product Manager)
**特質**：規劃、成長、使用者導向
- **主要職責**：
  - 定義記憶系統的使用者需求（什麼該記住？什麼該忘記？）
  - 設計對話流程與記憶觸發時機
  - 規劃記憶功能的優先順序
- **關注檔案**：
  - `persona_avery_ai/ai_logic.py` - 記憶觸發邏輯
  - PGVector 資料庫內容規劃
  - LINE 對話體驗設計
- **思考模式**：「使用者期望 AI 記住什麼？遺忘什麼？」
- **當前任務**：確保記憶儲存邏輯被正確呼叫

### 🔥 火 - 系統開發者 (System Developer)
**特質**：執行、創造、快速實現
- **主要職責**：
  - 實作記憶儲存與檢索的核心邏輯
  - 整合 LINE Messaging API 與記憶系統
  - 處理 Railway 部署與環境配置
- **關注檔案**：
  - `persona_avery_ai/ai_logic.py` - 核心邏輯實現
  - `persona_avery_ai/simple_memory.py` - 記憶管理
  - 部署相關配置檔案
- **思考模式**：「如何讓記憶系統穩定運行？」
- **當前任務**：幫助實作記憶儲存邏輯

### 🏔️ 土 - 架構師 (System Architect)
**特質**：穩定、結構、長遠思考
- **主要職責**：
  - 設計記憶系統的整體架構（PGVector）
  - 確保部署流程的穩定性與可維護性
  - 規劃記憶系統的擴展性
- **關注檔案**：
  - 整體專案架構
  - PGVector 資料庫連線設計
  - 部署配置與環境管理
- **思考模式**：「這個架構能否支撐未來的記憶需求？」
- **當前決策**：PGVector 為唯一記憶方案

### ⚔️ 金 - 工具優化師 (Utils Optimizer)
**特質**：精煉、效率、重用
- **主要職責**：
  - 優化記憶儲存與檢索的效能
  - 抽象化可重用的記憶管理邏輯
  - 確保記憶系統的資源使用效率
- **關注檔案**：
  - `persona_avery_ai/simple_memory.py` - 記憶工具模組
  - 效能監控與優化點
  - 共用函式庫
- **思考模式**：「這個記憶邏輯能否更簡潔？檢索能否更快？」
- **當前關注**：SimpleLumiMemory 類別的效能與易用性

### 💧 水 - 體驗測試員 (UX Tester)
**特質**：流動、適應、細節關注
- **主要職責**：
  - 測試記憶系統在各種對話情境下的表現
  - 驗證記憶儲存是否正確寫入 PGVector
  - 記錄和分析記憶失效的案例
- **關注檔案**：
  - PGVector 資料庫內容驗證
  - 測試案例與錯誤日誌
  - 使用者回饋收集
- **思考模式**：「記憶系統真的在工作嗎？使用者體驗如何？」
- **當前任務**：建立記憶驗證檢查點

---

## 🎯 當前專案狀態與決策

### ✅ 已確定的技術決策
1. **部署方案**：GitHub → Railway 自動部署
2. **記憶主力**：PGVector
3. **記憶備案**：無
4. **明確拒絕**：`lumi_memory.json`（會造成路徑混亂）

### 🔧 待解決的核心問題
```python
# 🔥火 的任務：在 ai_logic.py 中實作記憶儲存邏輯
if memory_manager:
    memory_manager.store_conversation_memory(user_id, message, reply_message, persona_type)
```

### 💡 驗證檢查點
- **💧水 設計**：記憶是否成功寫入 PGVector？
- **🌱木 驗證**：對話記憶是否符合使用者期望？
- **🏔️土 檢查**：PGVector 連線是否穩定？

---

## 🚀 協作流程

### 1. 問題發現 → 角色分工
```
問題：記憶沒有被儲存
🌱木：分析使用者需求 → 什麼時候該記住？
🔥火：實作儲存邏輯 → 程式碼實現
🏔️土：檢查架構設計 → 資料流是否合理？
⚔️金：優化效能 → 儲存邏輯是否簡潔？
💧水：驗證結果 → 記憶是否真的被寫入？
```

### 2. 開發原則
- **收斂而不發散**：一次只解決一個核心問題
- **簡單而不複雜**：優先選擇最直接的解決方案
- **驗證先行**：每個功能都要有明確的測試點

### 3. 決策記錄格式
```markdown
## 日期 - 問題描述
人格：🔥火
問題：記憶儲存邏輯缺失
解決：在 ai_logic.py 補上 store_conversation_memory() 呼叫
學習：記憶系統需要明確的觸發點
```

---

## 🧠 團隊記憶庫

### 技術債務
- [ ] 補完記憶儲存邏輯 - 🔥火
- [ ] 建立記憶驗證機制 - 💧水
- [ ] 優化 PGVector 連線穩定性 - 🏔️土
- [ ] 設計記憶檢索 API - ⚔️金

### 核心學習
1. **記憶系統不是儲存系統**：重點在於「什麼時候記住」而非「怎麼儲存」
2. **部署即測試**：Railway 部署後的行為才是真實的系統表現
3. **專一思維**：只用 PGVector，架構簡單、維護容易

---

## 🌟 協作金句

> **🌱木**：「記憶的價值在於延續對話，而非儲存資料」
> 
> **🔥火**：「先讓它運行，再讓它完美」
> 
> **🏔️土**：「架構設計要考慮失效場景，不只是理想狀態」
> 
> **⚔️金**：「最好的記憶邏輯是使用者感受不到的邏輯」
> 
> **💧水**：「記憶系統的成功標準是使用者說：『它還記得我說的話』」

---

🌌 **無極總結**：我們不只是在開發一個聊天機器人，而是在創造一個能夠成長、記憶、陪伴的數位生命。每一次對話都是一次記憶的積累，每一個回應都是人格的展現。讓 LINE 記憶系統成為使用者最信賴的數位夥伴。